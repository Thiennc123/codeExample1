{"ast":null,"code":"import \"antd/es/date-picker/style/css\";\nimport _DatePicker from \"antd/es/date-picker\";\nimport \"antd/es/row/style/css\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/col/style/css\";\nimport _Col from \"antd/es/col\";\nimport \"antd/es/input/style/css\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/form/style/css\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/select/style/css\";\nimport _Select from \"antd/es/select\";\nvar _jsxFileName = \"/home/thiennc/projects/airagri-frontend/src/containers/Pages/Mob/MobModal.js\";\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { propertyService, mobService, breedService } from '@iso/services';\nimport IntlMessages from '@iso/components/utility/intlMessages';\nimport MobModalWrapper from './MobModal.styles';\nimport _ from 'lodash';\nimport { objectColors } from '@iso/constants/objectColors';\nimport BreedModalWrapper from '@iso/containers/Pages/PropertyMap/components/Mob/BreedModal.styles';\nimport styled from \"styled-components\";\nimport modalActions from '@iso/redux/modal/actions';\nimport moment from 'moment';\nimport { dateHelper } from '@iso/lib/helpers/dateHelper';\nconst {\n  Option\n} = _Select;\nconst {\n  closeModal\n} = modalActions;\n\nconst MobModal = props => {\n  const dispatch = useDispatch();\n\n  const [form] = _Form.useForm();\n\n  const activePropertyId = useSelector(state => state.property.activePropertyId);\n\n  const [breedForm] = _Form.useForm();\n\n  const [loading, setLoading] = useState(false);\n  const modalVisibility = useSelector(state => state.modal.modalVisibility);\n  const modalData = useSelector(state => state.modal.modalData);\n  const [fields, setFields] = useState([]);\n  const [dataMob, setDataMob] = useState({});\n  const [modalLoading, setModalLoading] = useState(true);\n  const [breeds, setBreeds] = useState({});\n  const [visibleBreed, setVisibleBreed] = useState(false);\n  const [loadingBreed, setLoadingBreed] = useState(false);\n  const [primaryObjects, setPrimaryObjects] = useState({});\n  useEffect(() => {\n    if (activePropertyId) {\n      breedService.getList(activePropertyId).then(res => {\n        if (res.code === '0000') {\n          setBreeds(res.breeds);\n          setModalLoading(false);\n        }\n      });\n    }\n  }, [activePropertyId]);\n  useEffect(() => {\n    if (activePropertyId) {\n      propertyService.viewProperty(activePropertyId).then(res => {\n        if (res.code === '0000') {\n          setPrimaryObjects(res.primary_objects);\n          setModalLoading(false);\n        }\n      });\n    }\n  }, [activePropertyId]);\n\n  const handleSubmit = e => {\n    setLoading(true);\n    form.validateFields().then(values => {\n      onStore(values);\n    }).catch(info => {\n      console.log('Validate Failed:', info);\n      setLoading(false);\n    });\n    setLoading(false);\n  };\n\n  const handleBreedSubmit = e => {\n    breedForm.validateFields().then(breed_values => {\n      onStoreBreed(breed_values);\n    }).catch(info => {\n      console.log('Validate Failed:', info);\n      setLoadingBreed(false);\n    });\n  };\n\n  const addBreed = (object, e) => {\n    setVisibleBreed(true);\n  };\n\n  const cancelModalBreed = () => {\n    setVisibleBreed(false);\n  };\n\n  const onStoreBreed = breed_values => {\n    const breed_data = {\n      \"breed\": { ...breed_values.breed,\n        property_id: activePropertyId\n      }\n    };\n    breedService.storeOrUpdate(breed_data).then(res => {\n      if (res.code === '0000') {\n        var tmp_breeds = _.clone(breeds);\n\n        tmp_breeds.push(res.breed);\n        setBreeds(tmp_breeds);\n        cancelModalBreed();\n        breedForm.resetFields();\n        setFields([{\n          name: ['mob', 'breed'],\n          value: res.breed.slug\n        }]);\n      } else {\n        setLoadingBreed(false);\n      }\n    });\n  };\n\n  useEffect(() => {\n    if (modalData.type === 'mob') {\n      if (modalData.mob) {\n        setDataMob(modalData.mob);\n      }\n\n      setFields([{\n        name: ['mob', 'name'],\n        value: modalData.mob.name || ''\n      }, {\n        name: ['mob', 'type'],\n        value: modalData.mob.type || ''\n      }, {\n        name: ['mob', 'breed'],\n        value: modalData.mob.breed || ''\n      }, {\n        name: ['mob', 'tag_colour'],\n        value: modalData.mob.tag_colour || 'blue'\n      }, {\n        name: ['mob', 'tag_number_range'],\n        value: modalData.mob.tag_number_range || ''\n      }, {\n        name: ['mob', 'date_of_birth'],\n        value: modalData.mob.date_of_birth ? moment(modalData.mob.date_of_birth) : ''\n      }, {\n        name: ['mob', 'description'],\n        value: modalData.mob.description || ''\n      }, {\n        name: ['mob', 'primary_object_id'],\n        value: modalData.mob.primary_object_id || ''\n      }]);\n    }\n  }, [activePropertyId, modalVisibility, modalData.mob]);\n\n  const onStore = values => {\n    const data = {\n      \"mob\": { ...values.mob,\n        date_of_birth: values.mob.date_of_birth ? dateHelper.dateForAPI(values.mob.date_of_birth) : '',\n        point: dataMob.point,\n        property_id: activePropertyId\n      }\n    };\n    mobService.storeOrUpdate(data, dataMob.id).then(res => {\n      if (res.code === '0000') {\n        props.onSaved(res.mob);\n        cancelModal();\n        form.resetFields();\n      } else {\n        setLoading(false);\n      }\n    });\n  };\n\n  const renderOptionsColor = () => {\n    let options = [];\n\n    _.forEach(objectColors, (color, index) => {\n      options.push( /*#__PURE__*/React.createElement(Option, {\n        key: index,\n        value: color.value,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(ColorItemRow, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(ColorItemPreview, {\n        style: {\n          backgroundColor: color.color\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }\n      }, color.label))));\n    });\n\n    return /*#__PURE__*/React.createElement(_Select, {\n      placeholder: \"Select a color\",\n      allowClear: true,\n      size: \"large\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 7\n      }\n    }, options);\n  };\n\n  const renderOptionsBreed = mob_breed_options => {\n    let breed_options = [];\n\n    _.forEach(mob_breed_options, (breed_opt, index) => {\n      breed_options.push( /*#__PURE__*/React.createElement(Option, {\n        key: index,\n        value: breed_opt.slug,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 13\n        }\n      }, breed_opt.name)));\n    });\n\n    return /*#__PURE__*/React.createElement(_Select, {\n      placeholder: \"Select a breed\",\n      allowClear: true,\n      size: \"large\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 7\n      }\n    }, breed_options);\n  };\n\n  const renderOptionObject = objects => {\n    let options = [];\n\n    _.forEach(objects, (object, index) => {\n      options.push( /*#__PURE__*/React.createElement(Option, {\n        key: object.id,\n        value: object.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 9\n        }\n      }, object.name));\n    });\n\n    return /*#__PURE__*/React.createElement(_Select, {\n      placeholder: \"Select an object\",\n      allowClear: true,\n      size: \"large\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 7\n      }\n    }, options);\n  };\n\n  const cancelModal = () => {\n    dispatch(closeModal());\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(MobModalWrapper, {\n    visible: modalVisibility,\n    onCancel: cancelModal,\n    title: dataMob.id ? /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"propertyPage.modal.mob.editMob\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 27\n      }\n    }) : /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"propertyPage.modal.mob.addMob\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 81\n      }\n    }),\n    footer: [/*#__PURE__*/React.createElement(_Button, {\n      key: \"back\",\n      onClick: cancelModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"propertyPage.modal.cancel\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 12\n      }\n    })), /*#__PURE__*/React.createElement(_Button, {\n      key: \"submit\",\n      className: \"btn-success\",\n      type: \"primary\",\n      onClick: handleSubmit,\n      loading: loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"propertyPage.modal.save\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 12\n      }\n    }))],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(_Form, {\n    form: form,\n    layout: \"vertical\",\n    scrollToFirstError: true,\n    fields: fields,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['mob', 'name'],\n    className: \"isoInputWrapper\",\n    label: \"Name\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(_Input, {\n    size: \"large\",\n    placeholder: \"Input mob name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(_Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(_Col, {\n    xs: {\n      span: 15\n    },\n    md: {\n      span: 17\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['mob', 'breed'],\n    className: \"isoInputWrapper\",\n    label: \"Breed\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 17\n    }\n  }, renderOptionsBreed(breeds))), /*#__PURE__*/React.createElement(_Col, {\n    xs: {\n      span: 7,\n      offset: 2\n    },\n    md: {\n      span: 5,\n      offset: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(_Button, {\n    key: \"submit\",\n    className: \"btn-create-breed\",\n    type: \"primary\",\n    onClick: addBreed,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IntlMessages, {\n    id: \"propertyPage.modal.breed.addBreed\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 20\n    }\n  })))), /*#__PURE__*/React.createElement(_Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(_Col, {\n    xs: {\n      span: 24\n    },\n    md: {\n      span: 11\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['mob', 'date_of_birth'],\n    className: \"isoInputWrapper\",\n    label: \"Date Of Birth\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(_DatePicker, {\n    size: \"large\",\n    style: {\n      width: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 20\n    }\n  }))), /*#__PURE__*/React.createElement(_Col, {\n    xs: {\n      span: 24\n    },\n    md: {\n      span: 11,\n      offset: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['mob', 'type'],\n    className: \"isoInputWrapper\",\n    label: \"Type\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(_Input, {\n    size: \"large\",\n    placeholder: \"Input mob type\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 19\n    }\n  })))), /*#__PURE__*/React.createElement(_Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(_Col, {\n    xs: {\n      span: 24\n    },\n    md: {\n      span: 11\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['mob', 'tag_colour'],\n    className: \"isoInputWrapper\",\n    label: \"Tag Colour\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 17\n    }\n  }, renderOptionsColor())), /*#__PURE__*/React.createElement(_Col, {\n    xs: {\n      span: 24\n    },\n    md: {\n      span: 11,\n      offset: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['mob', 'tag_number_range'],\n    className: \"isoInputWrapper\",\n    label: \"Tag Number Range\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(_Input, {\n    size: \"large\",\n    placeholder: \"Input tag number range\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 19\n    }\n  })))), /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['mob', 'primary_object_id'],\n    className: \"isoInputWrapper\",\n    label: \"Object\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 13\n    }\n  }, renderOptionObject(primaryObjects)), /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['mob', 'description'],\n    className: \"isoInputWrapper\",\n    label: \"Description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(_Input.TextArea, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 15\n    }\n  }))))), /*#__PURE__*/React.createElement(BreedModalWrapper, {\n    visible: visibleBreed,\n    onCancel: cancelModalBreed,\n    title: /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"propertyPage.modal.breed.addBreed.title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 15\n      }\n    }),\n    footer: [/*#__PURE__*/React.createElement(_Button, {\n      key: \"back\",\n      onClick: cancelModalBreed,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"propertyPage.modal.cancel\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 12\n      }\n    })), /*#__PURE__*/React.createElement(_Button, {\n      key: \"submit\",\n      className: \"btn-success\",\n      type: \"primary\",\n      onClick: handleBreedSubmit,\n      loading: loadingBreed,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(IntlMessages, {\n      id: \"propertyPage.modal.save\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 12\n      }\n    }))],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(_Form, {\n    form: breedForm,\n    layout: \"vertical\",\n    scrollToFirstError: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    name: ['breed', 'name'],\n    className: \"isoInputWrapper\",\n    label: \"Breed\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(_Input, {\n    size: \"large\",\n    placeholder: \"Input breed\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 427,\n      columnNumber: 15\n    }\n  }))))));\n};\n\nexport default MobModal;\nconst ColorItemRow = styled.div`\n  display: flex;\n  align-items: center;\n  line-height: 30px;\n  div{\n    margin: 4px;\n  }\n`;\nconst ColorItemPreview = styled.div`\n  width: 16px;\n  height: 16px;\n  border-radius: 2px;\n`;","map":{"version":3,"sources":["/home/thiennc/projects/airagri-frontend/src/containers/Pages/Mob/MobModal.js"],"names":["React","useState","useEffect","useDispatch","useSelector","propertyService","mobService","breedService","IntlMessages","MobModalWrapper","_","objectColors","BreedModalWrapper","styled","modalActions","moment","dateHelper","Option","closeModal","MobModal","props","dispatch","form","useForm","activePropertyId","state","property","breedForm","loading","setLoading","modalVisibility","modal","modalData","fields","setFields","dataMob","setDataMob","modalLoading","setModalLoading","breeds","setBreeds","visibleBreed","setVisibleBreed","loadingBreed","setLoadingBreed","primaryObjects","setPrimaryObjects","getList","then","res","code","viewProperty","primary_objects","handleSubmit","e","validateFields","values","onStore","catch","info","console","log","handleBreedSubmit","breed_values","onStoreBreed","addBreed","object","cancelModalBreed","breed_data","breed","property_id","storeOrUpdate","tmp_breeds","clone","push","resetFields","name","value","slug","type","mob","tag_colour","tag_number_range","date_of_birth","description","primary_object_id","data","dateForAPI","point","id","onSaved","cancelModal","renderOptionsColor","options","forEach","color","index","backgroundColor","label","renderOptionsBreed","mob_breed_options","breed_options","breed_opt","renderOptionObject","objects","required","message","span","offset","width","ColorItemRow","div","ColorItemPreview"],"mappings":"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","sourcesContent":["import React , { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Form, Input, Button, Select, Row, Col, DatePicker } from 'antd';\nimport { propertyService, mobService, breedService } from '@iso/services';\nimport IntlMessages from '@iso/components/utility/intlMessages';\nimport MobModalWrapper from './MobModal.styles';\nimport _ from 'lodash';\nimport { objectColors } from '@iso/constants/objectColors';\nimport BreedModalWrapper from '@iso/containers/Pages/PropertyMap/components/Mob/BreedModal.styles';\nimport styled from \"styled-components\";\nimport modalActions from '@iso/redux/modal/actions';\nimport moment from 'moment';\nimport { dateHelper } from '@iso/lib/helpers/dateHelper';\n\nconst { Option } = Select;\nconst { closeModal } = modalActions;\n\nconst MobModal = (props) => {\n  const dispatch = useDispatch();\n  const [form] = Form.useForm();\n  const activePropertyId = useSelector((state) => state.property.activePropertyId);\n  const [breedForm] = Form.useForm();\n  const [loading, setLoading] = useState(false);\n  const modalVisibility = useSelector((state) => state.modal.modalVisibility);\n  const modalData = useSelector((state) => state.modal.modalData);\n  const [fields, setFields] = useState([]);\n  const [dataMob, setDataMob] = useState({});\n  const [modalLoading, setModalLoading] = useState(true);\n  const [breeds, setBreeds] = useState({});\n  const [visibleBreed, setVisibleBreed] = useState(false);\n  const [loadingBreed, setLoadingBreed] = useState(false);\n  const [primaryObjects, setPrimaryObjects] = useState({});\n\n  useEffect(() => {\n    if(activePropertyId){\n       breedService.getList(activePropertyId).then(res => {\n        if(res.code === '0000'){\n          setBreeds(res.breeds);\n          setModalLoading(false);\n        }\n      });\n    }\n  }, [activePropertyId]);\n\n  useEffect(() => {\n    if(activePropertyId){\n       propertyService.viewProperty(activePropertyId).then(res => {\n        if(res.code === '0000'){\n          setPrimaryObjects(res.primary_objects);\n          setModalLoading(false);\n        }\n      });\n    }\n  }, [activePropertyId]);\n\n  const handleSubmit = (e) => {\n    setLoading(true);\n\n    form\n      .validateFields()\n      .then(values => {\n        onStore(values);\n      })\n      .catch(info => {\n        console.log('Validate Failed:', info);\n        setLoading(false);\n      });\n    setLoading(false);\n  }\n\n  const handleBreedSubmit = (e) => {\n    breedForm\n      .validateFields()\n      .then(breed_values => {\n        onStoreBreed(breed_values);\n      })\n      .catch(info => {\n        console.log('Validate Failed:', info);\n        setLoadingBreed(false);\n      });\n  }\n\n  const addBreed = (object, e) => {\n    setVisibleBreed(true);\n  }\n\n  const cancelModalBreed = () => {\n    setVisibleBreed(false);\n  }\n\n  const onStoreBreed = (breed_values) => {\n    const breed_data = {\n      \"breed\":{\n        ...breed_values.breed,\n        property_id: activePropertyId\n      }\n    }\n\n    breedService.storeOrUpdate(breed_data).then(res => {\n      if(res.code === '0000'){\n        var tmp_breeds = _.clone(breeds);\n        tmp_breeds.push(res.breed);\n        setBreeds(tmp_breeds);\n        cancelModalBreed();\n        breedForm.resetFields();\n        setFields([\n          {\n            name: ['mob', 'breed'],\n            value: res.breed.slug,\n          },\n        ]);\n      } else {\n        setLoadingBreed(false);\n      }\n    });\n\n  }\n  useEffect(() => {\n    if(modalData.type === 'mob'){\n      if(modalData.mob){\n        setDataMob(modalData.mob);\n      }\n      setFields([\n        {\n          name: ['mob', 'name'],\n          value: modalData.mob.name || '',\n        },\n        {\n          name: ['mob', 'type'],\n          value: modalData.mob.type || '',\n        },\n        {\n          name: ['mob', 'breed'],\n          value: modalData.mob.breed || '',\n        },\n        {\n          name: ['mob', 'tag_colour'],\n          value: modalData.mob.tag_colour || 'blue',\n        },\n        {\n          name: ['mob', 'tag_number_range'],\n          value: modalData.mob.tag_number_range || '',\n        },\n        {\n          name: ['mob', 'date_of_birth'],\n          value: modalData.mob.date_of_birth ? moment(modalData.mob.date_of_birth) : '',\n        },\n        {\n          name: ['mob', 'description'],\n          value: modalData.mob.description || '',\n        },\n        {\n          name: ['mob', 'primary_object_id'],\n          value: modalData.mob.primary_object_id || '',\n        },\n      ]);\n    }\n  }, [activePropertyId, modalVisibility, modalData.mob]);\n\n  const onStore = (values) => {\n    const data = {\n      \"mob\":{\n        ...values.mob,\n        date_of_birth: values.mob.date_of_birth ? dateHelper.dateForAPI(values.mob.date_of_birth) : '',\n        point: dataMob.point,\n        property_id: activePropertyId\n      }\n    }\n\n    mobService.storeOrUpdate(data, dataMob.id).then(res => {\n      if(res.code === '0000'){\n        props.onSaved(res.mob);\n        cancelModal();\n        form.resetFields();\n      } else {\n        setLoading(false);\n      }\n    });\n  }\n\n  const renderOptionsColor = () => {\n    let options = [];\n    _.forEach(objectColors, (color, index) => {\n      options.push(\n        <Option key={index} value={color.value}>\n          <ColorItemRow>\n            <ColorItemPreview style={{backgroundColor: color.color}}></ColorItemPreview>\n            <div>{color.label}</div>\n          </ColorItemRow>\n        </Option>\n      );\n    })\n    return (\n      <Select\n        placeholder=\"Select a color\"\n        allowClear\n        size=\"large\"\n      >\n        {options}\n      </Select>\n    );\n  }\n\n  const renderOptionsBreed = (mob_breed_options) => {\n    let breed_options = [];\n     _.forEach(mob_breed_options, (breed_opt, index) => {\n      breed_options.push(\n        <Option key={index} value={breed_opt.slug}>\n            <div>{breed_opt.name}</div>\n        </Option>\n      );\n    })\n    return (\n      <Select\n        placeholder=\"Select a breed\"\n        allowClear\n        size=\"large\"\n      >\n        {breed_options}\n      </Select>\n    );\n  }\n\n  const renderOptionObject = (objects) => {\n    let options = [];\n    _.forEach(objects, (object, index) => {\n      options.push(\n        <Option key={object.id} value={object.id}>\n          {object.name}\n        </Option>\n      );\n    })\n    return (\n      <Select\n        placeholder=\"Select an object\"\n        allowClear\n        size=\"large\"\n      >\n        {options}\n      </Select>\n    );\n  }\n\n  const cancelModal = () => {\n    dispatch(closeModal());\n  }\n\n  return(\n    <>\n    <MobModalWrapper\n      visible={modalVisibility}\n      onCancel={cancelModal}\n      title={dataMob.id ? <IntlMessages id=\"propertyPage.modal.mob.editMob\"/> : <IntlMessages id=\"propertyPage.modal.mob.addMob\"/>}\n      footer={[\n        <Button key=\"back\" onClick={cancelModal}>\n          {<IntlMessages id=\"propertyPage.modal.cancel\" />}\n        </Button>,\n        <Button key=\"submit\" className=\"btn-success\" type=\"primary\" onClick={handleSubmit} loading={loading}>\n          {<IntlMessages id=\"propertyPage.modal.save\" />}\n        </Button>,\n      ]}\n    >\n      {\n        \n          <Form\n            form={form}\n            layout=\"vertical\"\n            scrollToFirstError\n            fields={fields}\n          >\n          <div className=\"form-body\">\n            <Form.Item\n              name={['mob', 'name']}\n              className=\"isoInputWrapper\"\n              label=\"Name\"\n              rules={[\n                {\n                  required: true,\n                  message: 'This field is required',\n                },\n              ]}\n            >\n              <Input size=\"large\" placeholder=\"Input mob name\"/>\n            </Form.Item>\n            <Row>\n              <Col xs={{span: 15}} md={{span: 17}}>\n                <Form.Item\n                  name={['mob', 'breed']}\n                  className=\"isoInputWrapper\"\n                  label=\"Breed\"\n                  rules={[\n                    {\n                      required: true,\n                      message: 'This field is required',\n                    },\n                  ]}\n                >\n                {renderOptionsBreed(breeds)}\n                </Form.Item>\n              </Col>\n              <Col xs={{span: 7, offset: 2}} md={{span: 5, offset: 2}}>\n                <Button key=\"submit\" className=\"btn-create-breed\" type=\"primary\" onClick={addBreed}>\n                  {<IntlMessages id=\"propertyPage.modal.breed.addBreed\" />}\n                </Button>\n              </Col>\n            </Row>\n            <Row>\n              <Col xs={{span: 24}} md={{span: 11}}>\n                <Form.Item\n                  name={['mob', 'date_of_birth']}\n                  className=\"isoInputWrapper\"\n                  label=\"Date Of Birth\"\n                  rules={[\n                    {\n                      required: true,\n                      message: 'This field is required',\n                    },\n                  ]}\n                >\n                   <DatePicker size=\"large\" style={{width: '100%'}}/>\n                </Form.Item>\n              </Col>\n              <Col xs={{span: 24}} md={{span: 11, offset: 2}}>\n                <Form.Item\n                  name={['mob', 'type']}\n                  className=\"isoInputWrapper\"\n                  label=\"Type\"\n                  rules={[\n                    {\n                      required: true,\n                      message: 'This field is required',\n                    },\n                  ]}\n                >\n                  <Input size=\"large\" placeholder=\"Input mob type\"/>\n                </Form.Item>\n              </Col>\n            </Row>\n            <Row>\n              <Col xs={{span: 24}} md={{span: 11}}>\n                <Form.Item\n                  name={['mob', 'tag_colour']}\n                  className=\"isoInputWrapper\"\n                  label=\"Tag Colour\"\n                  rules={[\n                    {\n                      required: true,\n                      message: 'This field is required',\n                    },\n                  ]}\n                >\n                  {renderOptionsColor()}\n                </Form.Item>\n              </Col>\n              <Col xs={{span: 24}} md={{span: 11, offset: 2}}>\n                <Form.Item\n                  name={['mob', 'tag_number_range']}\n                  className=\"isoInputWrapper\"\n                  label=\"Tag Number Range\"\n                  rules={[\n                    {\n                      required: true,\n                      message: 'This field is required',\n                    },\n                  ]}\n                >\n                  <Input size=\"large\" placeholder=\"Input tag number range\"/>\n                </Form.Item>\n              </Col>\n            </Row>\n           \n            <Form.Item\n              name={['mob', 'primary_object_id']}\n              className=\"isoInputWrapper\"\n              label=\"Object\"\n              rules={[\n                {\n                  required: true,\n                  message: 'This field is required',\n                },\n              ]}\n            >\n              {renderOptionObject(primaryObjects)}\n            </Form.Item>\n            <Form.Item\n              name={['mob', 'description']}\n              className=\"isoInputWrapper\"\n              label=\"Description\"\n            >\n              <Input.TextArea />\n            </Form.Item>\n          </div>  \n      </Form>\n    }\n    </MobModalWrapper>\n    <BreedModalWrapper\n      visible={visibleBreed}\n      onCancel={cancelModalBreed}\n      title={ <IntlMessages id=\"propertyPage.modal.breed.addBreed.title\"/> }\n      footer={[\n        <Button key=\"back\" onClick={cancelModalBreed}>\n          {<IntlMessages id=\"propertyPage.modal.cancel\" />}\n        </Button>,\n        <Button key=\"submit\" className=\"btn-success\" type=\"primary\" onClick={handleBreedSubmit} loading={loadingBreed}>\n          {<IntlMessages id=\"propertyPage.modal.save\" />}\n        </Button>,\n      ]}\n    >\n    {\n      <Form\n            form={breedForm}\n            layout=\"vertical\"\n            scrollToFirstError\n          >\n          <div className=\"form-body\">\n            <Form.Item\n              name={['breed', 'name']}\n              className=\"isoInputWrapper\"\n              label=\"Breed\"\n              rules={[\n                {\n                  required: true,\n                  message: 'This field is required',\n                },\n              ]}\n            >\n              <Input size=\"large\" placeholder=\"Input breed\"/>\n            </Form.Item>\n            </div>    \n      </Form>\n    }\n    </BreedModalWrapper>\n    </>\n  )\n}\n\nexport default MobModal;\n\nconst ColorItemRow = styled.div`\n  display: flex;\n  align-items: center;\n  line-height: 30px;\n  div{\n    margin: 4px;\n  }\n`;\n\nconst ColorItemPreview = styled.div`\n  width: 16px;\n  height: 16px;\n  border-radius: 2px;\n`;"]},"metadata":{},"sourceType":"module"}